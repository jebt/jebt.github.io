var metaLoop=1E5,preset=0,grid,x,y,dir,img,NORTH=0,EAST=1,SOUTH=2,WEST=3,directions=4,states=2,s0=0,s1=1,step=0,R=255,G=255,B=255,A=255,dark=0,bright=0,dark2=0,disco,countDirR=!0,countDirG=!0,countDirB=!0,countDirA=!0,countDirDark=!0;
function changePixel(){dark2=Math.floor(dist(x,y,width/2,height/2));bright=150-Math.floor(dist(x,y,width/2,height/2));0===step%1&&(countDirR?(R+=.07,400<R&&(countDirR=!1)):(R-=9,0>R&&(countDirR=!0)));0===step%1&&(countDirG?(G+=.02,450<G&&(countDirG=!1)):(G-=.03,0>G&&(countDirG=!0)));0===step%1&&(countDirB?(B+=3,50<B&&(countDirB=!1)):(B-=2,0>B&&(countDirB=!0)));0===step%9&&(countDirDark?(dark++,255<dark&&(countDirDark=!1)):(dark--,0>dark&&(countDirDark=!0)));0===step%127&&(countDirA?(A++,150<A&&(countDirA=
!1)):(A--,0>A&&(countDirA=!0)));disco=color(Math.floor(R-(dark+dark2)+bright),Math.floor(G-(dark+dark2)+bright),Math.floor(B-(dark+dark2)+bright),A);switch(grid[x][y]){case 0:img.set(x,y,disco);break;case 1:img.set(x,y,disco)}}
function setup(){frameRate(30);createCanvas(600,600);background(0);img=createImage(width,height);img.loadPixels();for(var a=0;a<img.pixels.length;a++)img.pixels[a]=color(0);img.updatePixels();image(img,0,0);grid=Array(width).fill().map(function(){return Array(height).fill(0)});x=width/2;y=height/2;dir=NORTH}function turn(){switch(grid[x][y]){case 0:dirChange(s0);break;case 1:dirChange(s1)}dir>=directions?dir=0:0>dir&&(dir=directions-1)}function dirChange(a){0===a?dir--:1===a&&dir++}
function changeState(){grid[x][y]++;grid[x][y]>=states&&(grid[x][y]=0)}function move(){switch(dir){case NORTH:y--;break;case 1:x++;break;case 2:y++;break;case 3:x--}x>width-1?x=0:0>x&&(x=width-1);y>height-1?y=0:0>y&&(y=height-1)}function feedBack(){console.log("\r\n\r\n\r\nStep#:      "+step/1E9+" Billion");console.log("fps:        "+frameRate())}
function draw(){for(var a=0;a<metaLoop;a++)turn(),changeState(),changePixel(),move(),step++;0===frameCount%100&&(console.log("fps: "+frameRate()),console.log("frame number: "+frameCount));img.updatePixels();image(img,0,0)};